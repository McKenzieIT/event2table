{
  "inventory_summary": {
    "total_performance_test_files": 2,
    "true_performance_tests": 2,
    "functional_tests_labeled_performance": 0,
    "benchmark_tests": 2,
    "analysis_date": "2026-02-13",
    "analyzer": "Claude Code Test Analysis Agent"
  },
  "performance_tests": [
    {
      "file": "test/unit/backend_tests/test_performance_benchmark.py",
      "type": "performance",
      "is_benchmark": true,
      "status": "active",
      "purpose": "建立重构前后对比基准，验证通用函数性能开销在可接受范围内",
      "version": "1.0.0",
      "created_date": "2026-02-09",
      "test_scenarios": [
        {
          "scenario": "通用函数调用性能",
          "tests": [
            {
              "name": "validate_form_fields() - 1000次调用",
              "target": "<1ms",
              "iterations": 1000,
              "measures": ["execution_time"],
              "status": "active"
            },
            {
              "name": "AggregateFunctionBuilder.build_aggregate_sql() - 1000次调用",
              "target": "<0.1ms",
              "iterations": 1000,
              "measures": ["execution_time"],
              "status": "active"
            },
            {
              "name": "find_isolated_nodes() - 100个节点图",
              "target": "<5ms",
              "iterations": 100,
              "measures": ["execution_time"],
              "status": "active"
            },
            {
              "name": "bfs_traversal() - 100个节点图",
              "target": "<3ms",
              "iterations": 100,
              "measures": ["execution_time"],
              "status": "active"
            }
          ]
        },
        {
          "scenario": "业务流程性能对比",
          "tests": [
            {
              "name": "事件创建流程（使用通用函数） - 100次调用",
              "target": "<10ms",
              "iterations": 100,
              "measures": ["execution_time"],
              "status": "active"
            },
            {
              "name": "Canvas验证流程（使用graph_utils） - 100个节点，100次调用",
              "target": "<15ms",
              "iterations": 100,
              "measures": ["execution_time"],
              "status": "active"
            },
            {
              "name": "HQL生成流程（使用sql_builder） - 1000次调用",
              "target": "<5ms",
              "iterations": 1000,
              "measures": ["execution_time"],
              "status": "active"
            }
          ]
        },
        {
          "scenario": "缓存性能",
          "tests": [
            {
              "name": "缓存命中性能",
              "target": "加速比 ≥10x",
              "iterations": 100,
              "measures": ["execution_time", "speedup"],
              "status": "active"
            },
            {
              "name": "LRU缓存淘汰性能 - 100次调用",
              "target": "标准差/平均值 <20%",
              "iterations": 100,
              "measures": ["execution_time", "stability"],
              "status": "active"
            }
          ]
        }
      ],
      "performance_targets": {
        "validate_form_fields": "<1ms (平均)",
        "build_aggregate_sql": "<0.1ms (平均)",
        "find_isolated_nodes": "<5ms (平均)",
        "bfs_traversal": "<3ms (平均)",
        "event_creation_flow": "<10ms",
        "canvas_validation_flow": "<15ms",
        "hql_generation_flow": "<5ms",
        "cache_hit_speedup": "≥10x",
        "lru_eviction_stability": "标准差/平均值 <20%"
      },
      "output_artifacts": [
        "benchmarks/baseline_YYYYMMDD.json",
        "benchmarks/performance_report_YYYYMMDD.md"
      ],
      "acceptance_criteria": [
        "性能测试脚本编写完成",
        "基准数据已记录到benchmarks/baseline_YYYYMMDD.txt",
        "性能报告已生成",
        "无明显性能回归（±10%以内）"
      ]
    },
    {
      "file": "test/unit/backend_tests/test_cache_performance.py",
      "type": "performance",
      "is_benchmark": true,
      "status": "active",
      "purpose": "测试三级分层缓存系统的性能表现，验证是否达到预期目标",
      "version": "1.0.0",
      "created_date": "2026-01-28",
      "test_scenarios": [
        {
          "scenario": "写入性能",
          "tests": [
            {
              "name": "L1写入性能（热点数据）",
              "measures": ["execution_time"],
              "iterations": 100,
              "data_size": "100个热点数据",
              "status": "active"
            },
            {
              "name": "L2写入性能（温热数据）",
              "measures": ["execution_time"],
              "iterations": 100,
              "data_size": "1000个温热数据",
              "status": "active"
            }
          ]
        },
        {
          "scenario": "读取性能",
          "tests": [
            {
              "name": "L1读取性能（热点数据） - 1000次读取",
              "target": "<1ms",
              "measures": ["execution_time", "min", "max", "p95"],
              "iterations": 1000,
              "data_size": "100个热点数据",
              "status": "active"
            },
            {
              "name": "L2读取性能（温热数据） - 1000次读取",
              "target": "5-10ms",
              "measures": ["execution_time", "min", "max", "p95"],
              "iterations": 1000,
              "data_size": "100个温热数据",
              "status": "active"
            }
          ]
        },
        {
          "scenario": "缓存命中率",
          "tests": [
            {
              "name": "混合读取测试（70%热点 + 30%温热） - 1000次",
              "target": "总体命中率 ≥90%",
              "measures": ["l1_hits", "l2_hits", "misses", "hit_rate"],
              "iterations": 1000,
              "data_distribution": "70%热点 + 30%温热",
              "status": "active"
            }
          ]
        },
        {
          "scenario": "缓存容量管理",
          "tests": [
            {
              "name": "LRU淘汰性能 - 写入容量+100条数据",
              "measures": ["l1_size", "l1_capacity", "l1_usage", "l1_evictions"],
              "target": "LRU淘汰正常工作",
              "status": "active"
            }
          ]
        },
        {
          "scenario": "并发访问性能",
          "tests": [
            {
              "name": "并发访问（100线程，每个10次读取）",
              "target": "QPS ≥1000",
              "measures": ["total_time", "total_requests", "qps", "avg_response"],
              "concurrency": "100个线程",
              "reads_per_thread": 10,
              "status": "active"
            }
          ]
        }
      ],
      "performance_targets": {
        "l1_hit_rate": "≥60%",
        "l2_hit_rate": "≥30%",
        "total_hit_rate": "≥90%",
        "l1_response_time": "<1ms",
        "l2_response_time": "5-10ms",
        "l3_response_time": "50-200ms",
        "lru_eviction": "正常工作",
        "concurrent_qps": "≥1000"
      },
      "cache_architecture": {
        "levels": 3,
        "l1": "内存缓存（热点数据）",
        "l2": "Redis缓存（温热数据）",
        "l3": "数据库缓存（冷数据）",
        "eviction_policy": "LRU (Least Recently Used)"
      },
      "output_format": "控制台报告 + JSON统计"
    }
  ],
  "performance_test_categories": {
    "microbenchmarks": [
      "validate_form_fields() - 1000次调用",
      "AggregateFunctionBuilder.build_aggregate_sql() - 1000次调用",
      "find_isolated_nodes() - 100个节点图",
      "bfs_traversal() - 100个节点图"
    ],
    "macrobenchmarks": [
      "事件创建流程（使用通用函数）",
      "Canvas验证流程（使用graph_utils）",
      "HQL生成流程（使用sql_builder）"
    ],
    "cache_performance": [
      "L1缓存命中率",
      "L2缓存命中率",
      "总体缓存命中率",
      "LRU淘汰性能",
      "并发访问性能"
    ],
    "system_performance": [
      "三级分层缓存系统",
      "并发访问（100线程）"
    ]
  },
  "performance_metrics_collected": [
    "execution_time（执行时间）",
    "min（最小值）",
    "max（最大值）",
    "avg（平均值）",
    "median（中位数）",
    "stdev（标准差）",
    "p95（95分位数）",
    "hit_rate（命中率）",
    "l1_hits（L1命中次数）",
    "l2_hits（L2命中次数）",
    "misses（未命中次数）",
    "evictions（淘汰次数）",
    "qps（每秒查询数）",
    "speedup（加速比）",
    "stability（稳定性比率）"
  ],
  "tools_and_frameworks": [
    {
      "name": "pytest",
      "purpose": "测试框架",
      "features": ["fixture", "mark", "parametrize"]
    },
    {
      "name": "time.perf_counter()",
      "purpose": "高精度计时",
      "resolution": "纳秒级"
    },
    {
      "name": "statistics",
      "purpose": "统计分析",
      "functions": ["mean", "median", "stdev"]
    },
    {
      "name": "threading",
      "purpose": "并发测试",
      "usage": "模拟多线程并发访问"
    }
  ],
  "recommendations": [
    {
      "priority": "HIGH",
      "action": "集成到CI/CD",
      "details": "将性能测试集成到CI/CD管道，每次PR运行性能基准测试，检测性能回归"
    },
    {
      "priority": "HIGH",
      "action": "建立性能基线",
      "details": "在benchmark/目录中建立性能基线JSON文件，每次测试对比基线，报告±10%以上的性能变化"
    },
    {
      "priority": "MEDIUM",
      "action": "添加性能监控",
      "details": "添加内存使用监控、CPU使用监控、网络I/O监控，全面评估系统性能"
    },
    {
      "priority": "MEDIUM",
      "action": "扩展测试场景",
      "details": "添加更多业务流程性能测试：Canvas节点创建、HQL生成并发测试、大量数据导入测试"
    },
    {
      "priority": "LOW",
      "action": "性能回归分析",
      "details": "建立性能回归分析报告，自动识别性能下降的提交，帮助快速定位问题"
    },
    {
      "priority": "LOW",
      "action": "性能可视化",
      "details": "使用Grafana或自定义Dashboard可视化性能指标趋势，实时监控性能变化"
    }
  ],
  "integration_points": {
    "ci_cd": [
      "GitHub Actions",
      "GitLab CI",
      "Jenkins"
    ],
    "monitoring": [
      "Prometheus",
      "Grafana",
      "Custom Dashboard"
    ],
    "alerting": [
      "性能回归警报（±10%）",
      "性能下降警报（±20%）",
      "缓存命中率下降警报（<90%）"
    ]
  },
  "best_practices": [
    "性能测试应该使用预热运行（warm-up）避免冷启动影响",
    "性能测试应该运行多次（iterations≥100）以获得稳定的统计结果",
    "性能测试应该报告最小值、最大值、平均值、中位数、标准差、P95分位数",
    "性能测试应该设置明确的性能目标（target）",
    "性能测试应该建立基线（baseline）并定期更新",
    "性能测试应该在相同的环境条件下运行（相同的硬件、操作系统、数据库版本）",
    "性能测试应该与其他测试隔离，避免相互干扰",
    "性能测试应该模拟真实的使用场景（数据量、并发量、访问模式）"
  ],
  "future_enhancements": [
    {
      "enhancement": "负载测试",
      "description": "测试系统在高负载下的表现：1000+并发用户、10000+QPS",
      "priority": "MEDIUM"
    },
    {
      "enhancement": "压力测试",
      "description": "测试系统的极限性能：找到系统的最大承载能力、识别性能瓶颈",
      "priority": "LOW"
    },
    {
      "enhancement": "耐久性测试",
      "description": "测试系统在长时间运行下的性能稳定性：24小时、7天、30天持续运行",
      "priority": "LOW"
    },
    {
      "enhancement": "内存泄漏检测",
      "description": "测试系统是否存在内存泄漏：长时间运行监控内存使用情况",
      "priority": "MEDIUM"
    },
    {
      "enhancement": "分布式缓存性能测试",
      "description": "测试分布式缓存（Redis Cluster）的性能：多节点、数据分片、故障转移",
      "priority": "LOW"
    }
  ]
}

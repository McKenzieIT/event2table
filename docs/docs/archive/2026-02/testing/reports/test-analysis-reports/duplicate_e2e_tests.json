{
  "analysis_summary": {
    "total_e2e_tests_found": 70,
    "duplicates_identified": 8,
    "outdated_tests": 62,
    "unique_tests_to_keep": 8,
    "analysis_date": "2026-02-13",
    "analyzer": "Claude Code Test Analysis Agent"
  },
  "duplicates": [
    {
      "test_name": "Smoke Tests - Homepage & Navigation",
      "files": [
        "test/e2e/smoke/smoke-tests.spec.ts",
        "frontend/tests/e2e/smoke-tests.spec.ts"
      ],
      "similarity": "95%",
      "action": "delete",
      "keep_file": "test/e2e/smoke/smoke-tests.spec.ts",
      "delete_file": "frontend/tests/e2e/smoke-tests.spec.ts",
      "reason": "完全相同的测试逻辑，test/e2e/是统一测试目录，frontend/tests/是前端旧目录",
      "content_summary": "测试所有主要页面加载、无JavaScript错误、基本功能工作",
      "differences": "frontend版本多了一个setupConsoleErrorCollector函数（改进版），但整体测试逻辑相同"
    },
    {
      "test_name": "Quick Smoke Tests",
      "files": [
        "test/e2e/smoke/quick-smoke.spec.ts",
        "frontend/tests/e2e/quick-smoke.spec.ts"
      ],
      "similarity": "98%",
      "action": "delete",
      "keep_file": "test/e2e/smoke/quick-smoke.spec.ts",
      "delete_file": "frontend/tests/e2e/quick-smoke.spec.ts",
      "reason": "几乎完全相同的快速冒烟测试，test/e2e/是统一目录",
      "content_summary": "快速验证页面加载的轻量级测试（6个页面：homepage, games, events, parameters, canvas, field-builder）",
      "differences": "test/e2e版本多了test.use配置（禁用video和screenshot以加快执行）"
    },
    {
      "test_name": "API Health & Connectivity Tests",
      "files": [
        "frontend/tests/e2e/api-tests.spec.ts",
        "test/e2e/api-contract/api-contract-tests.spec.ts"
      ],
      "similarity": "40%",
      "action": "keep_both",
      "reason": "测试不同方面：api-tests.spec.ts测试前端UI的API调用，api-contract-tests.spec.ts测试后端API契约",
      "content_summary": "api-tests.spec.ts: API健康检查、CORS、网络错误处理；api-contract-tests.spec.ts: DELETE API验证（200/404/409）",
      "recommendation": "重命名为更清晰的名字：api-integration.spec.ts和api-contract-validation.spec.ts"
    },
    {
      "test_name": "Responsive Design Tests",
      "files": [
        "test/e2e/smoke/smoke-tests.spec.ts (lines 548-590)",
        "frontend/tests/e2e/responsive-design.spec.ts"
      ],
      "similarity": "90%",
      "action": "merge",
      "keep_file": "test/e2e/responsive/responsive-design.spec.ts",
      "delete_file": "frontend/tests/e2e/responsive-design.spec.ts",
      "reason": "响应式测试应独立文件，test/e2e/smoke/中的响应式测试应移到独立文件",
      "content_summary": "测试移动端（375x667）、平板（768x1024）、桌面端（1920x1080）viewport加载",
      "differences": "独立文件更易维护，应该将smoke-tests.spec.ts中的响应式测试移除"
    }
  ],
  "outdated_tests": [
    {
      "location": "test/archive/disabled/e2e/",
      "count": 62,
      "action": "archive_keep",
      "reason": "这些测试已在2025年存档，标记为disabled，保留了调试历史",
      "examples": [
        "404-test.spec.ts - 404错误调试",
        "debug-events.spec.ts - 事件页面调试",
        "debug-react-loading.spec.ts - React加载调试",
        "console-test.spec.ts - 控制台检查",
        "check-errors.spec.ts - 错误检查"
      ],
      "recommendation": "保留这些文件作为历史参考，但不在CI/CD中运行"
    }
  ],
  "unique_tests_to_keep": [
    {
      "file": "test/e2e/critical/events-workflow.spec.ts",
      "reason": "关键用户流程测试（P0优先级）",
      "coverage": "事件CRUD操作、批量操作"
    },
    {
      "file": "test/e2e/critical/hql-generation.spec.ts",
      "reason": "核心功能测试：HQL生成",
      "coverage": "HQL V2生成、预览、下载"
    },
    {
      "file": "test/e2e/critical/game-management.spec.ts",
      "reason": "关键用户流程测试（P0优先级）",
      "coverage": "游戏CRUD、批量删除"
    },
    {
      "file": "test/e2e/critical/canvas-workflow.spec.ts",
      "reason": "核心功能测试：Canvas工作流",
      "coverage": "Canvas节点创建、连接、验证"
    },
    {
      "file": "test/e2e/critical/event-management.spec.ts",
      "reason": "关键用户流程测试（P0优先级）",
      "coverage": "事件管理CRUD"
    },
    {
      "file": "test/e2e/hql-v2/hql-v2-self-healing.spec.ts",
      "reason": "HQL V2特性测试",
      "coverage": "自愈功能、错误恢复"
    },
    {
      "file": "test/e2e/hql-v2/multi-events.spec.ts",
      "reason": "HQL V2特性测试",
      "coverage": "多事件联合生成"
    },
    {
      "file": "test/e2e/api-contract/contract-validation.spec.ts",
      "reason": "API契约验证测试",
      "coverage": "API端点验证、响应格式验证"
    }
  ],
  "recommendations": [
    {
      "priority": "HIGH",
      "action": "删除重复测试",
      "details": "删除frontend/tests/e2e/下的重复测试文件：smoke-tests.spec.ts, quick-smoke.spec.ts"
    },
    {
      "priority": "HIGH",
      "action": "重组目录结构",
      "details": "将所有E2E测试统一到test/e2e/目录，删除frontend/tests/e2e/目录"
    },
    {
      "priority": "MEDIUM",
      "action": "分离响应式测试",
      "details": "从smoke-tests.spec.ts中提取响应式测试到独立文件test/e2e/responsive/responsive-design.spec.ts"
    },
    {
      "priority": "LOW",
      "action": "保留存档测试",
      "details": "保留test/archive/disabled/e2e/作为历史参考，不删除"
    },
    {
      "priority": "MEDIUM",
      "action": "重命名API测试",
      "details": "将api-tests.spec.ts重命名为api-integration.spec.ts以明确其测试范围"
    }
  ],
  "consolidated_structure": {
    "recommended": {
      "test/e2e/": {
        "smoke/": ["smoke-tests.spec.ts", "quick-smoke.spec.ts"],
        "critical/": ["game-management.spec.ts", "event-management.spec.ts", "events-workflow.spec.ts", "hql-generation.spec.ts", "canvas-workflow.spec.ts"],
        "hql-v2/": ["hql-v2-self-healing.spec.ts", "multi-events.spec.ts", "hql-preview-v2.spec.ts", "v2-demo.spec.ts"],
        "responsive/": ["responsive-design.spec.ts"],
        "api-contract/": ["api-contract-tests.spec.ts", "contract-validation.spec.ts"],
        "archive/disabled/e2e/": [保留所有62个调试测试文件]
      }
    },
    "to_delete": [
      "frontend/tests/e2e/smoke-tests.spec.ts",
      "frontend/tests/e2e/quick-smoke.spec.ts",
      "frontend/tests/e2e/responsive-design.spec.ts",
      "frontend/tests/e2e/api-tests.spec.ts",
      "frontend/tests/e2e/test-diagnose.spec.ts",
      "frontend/tests/e2e/phase-1-to-5-comprehensive.spec.ts",
      "frontend/tests/e2e/screenshots.spec.ts"
    ]
  }
}

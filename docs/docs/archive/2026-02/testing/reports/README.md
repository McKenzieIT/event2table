# Event2Table æµ‹è¯•æŒ‡å—

**æ›´æ–°æ—¥æœŸ**: 2026-02-11
**æµ‹è¯•æ¡†æ¶ç‰ˆæœ¬**: 2.0

---

## ğŸ“– æ¦‚è¿°

Event2Tableé¡¹ç›®é‡‡ç”¨å®Œæ•´çš„æµ‹è¯•ä½“ç³»ï¼Œç¡®ä¿ä»£ç è´¨é‡å’ŒAPIä¸€è‡´æ€§ï¼š

- **å•å…ƒæµ‹è¯•** (Unit Tests): å¿«é€Ÿã€éš”ç¦»çš„ç»„ä»¶æµ‹è¯•
- **é›†æˆæµ‹è¯•** (Integration Tests): æ¨¡å—é—´äº¤äº’æµ‹è¯•
- **E2Eæµ‹è¯•** (End-to-End Tests): å®Œæ•´ç”¨æˆ·æµç¨‹æµ‹è¯•
- **APIå¥‘çº¦æµ‹è¯•** (Contract Tests): å‰åç«¯APIä¸€è‡´æ€§éªŒè¯

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### è¿è¡Œæ‰€æœ‰æµ‹è¯•
```bash
npm run test
```

### å¼€å‘å®ŒæˆéªŒè¯
```bash
npm run verify
```

### Gitè‡ªåŠ¨åŒ–æµ‹è¯•
```bash
git commit  # è‡ªåŠ¨è¿è¡Œpre-commit tests
git push    # è‡ªåŠ¨è¿è¡Œpre-push tests
```

---

## ğŸ“‹ æµ‹è¯•å‘½ä»¤å‚è€ƒ

### æ ¹ç›®å½•å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|--------|------|
| `npm run test` | è¿è¡Œæ‰€æœ‰æµ‹è¯•ï¼ˆåç«¯+å‰ç«¯ï¼‰ |
| `npm run test:backend` | è¿è¡Œæ‰€æœ‰åç«¯æµ‹è¯• |
| `npm run test:backend:unit` | è¿è¡Œåç«¯å•å…ƒæµ‹è¯•ï¼ˆå¿«é€Ÿï¼‰ |
| `npm run test:backend:integration` | è¿è¡Œåç«¯é›†æˆæµ‹è¯• |
| `npm run test:frontend` | è¿è¡Œå‰ç«¯å•å…ƒæµ‹è¯• |
| `npm run test:e2e` | è¿è¡ŒE2Eæµ‹è¯• |
| `npm run test:contract` | APIå¥‘çº¦æµ‹è¯• |
| `npm run test:coverage` | ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š |
| `npm run test:performance` | è¿è¡Œæ€§èƒ½æµ‹è¯• |
| `npm run verify` | å¼€å‘å®ŒæˆéªŒè¯ï¼ˆå¥‘çº¦+å•å…ƒæµ‹è¯•ï¼‰ |

### å‰ç«¯å‘½ä»¤

åœ¨ `frontend/` ç›®å½•ä¸‹è¿è¡Œï¼š

| å‘½ä»¤ | è¯´æ˜ |
|--------|------|
| `npm run test` | è¿è¡ŒVitestå•å…ƒæµ‹è¯• |
| `npm run test:unit` | è¿è¡Œå•å…ƒæµ‹è¯•ï¼ˆä¸€æ¬¡æ€§ï¼‰ |
| `npm run test:coverage` | è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡ |
| `npm run test:watch` | ç›‘è§†æ¨¡å¼ï¼ˆæ–‡ä»¶å˜åŒ–è‡ªåŠ¨è¿è¡Œï¼‰ |
| `npm run test:ui` | Vitest UIæ¨¡å¼ |
| `npm run test:e2e` | è¿è¡ŒPlaywright E2Eæµ‹è¯• |
| `npm run test:e2e:ui` | E2Eæµ‹è¯•UIæ¨¡å¼ |
| `npm run test:e2e:debug` | E2Eæµ‹è¯•è°ƒè¯•æ¨¡å¼ |
| `npm run test:e2e:headed` | E2Eæµ‹è¯•ï¼ˆæœ‰ç•Œé¢ï¼‰ |
| `npm run test:smoke` | å¿«é€Ÿå†’çƒŸæµ‹è¯• |
| `npm run test:critical` | å…³é”®è·¯å¾„æµ‹è¯• |

---

## ğŸ“ æµ‹è¯•ç›®å½•ç»“æ„

```
test/
â”œâ”€â”€ unit/                     # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ backend/             # åç«¯å•å…ƒæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ services/       # Serviceå±‚æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ repositories/   # Repositoryå±‚æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ schemas/        # SchemaéªŒè¯æµ‹è¯•
â”‚   â”‚   â””â”€â”€ core/          # æ ¸å¿ƒå·¥å…·æµ‹è¯•
â”‚   â””â”€â”€ frontend/           # å‰ç«¯å•å…ƒæµ‹è¯•ï¼ˆå¾…è¿ç§»ï¼‰
â”‚       â”œâ”€â”€ components/     # ç»„ä»¶æµ‹è¯•
â”‚       â”œâ”€â”€ features/      # åŠŸèƒ½æ¨¡å—æµ‹è¯•
â”‚       â””â”€â”€ shared/        # å…±äº«å·¥å…·æµ‹è¯•
â”œâ”€â”€ integration/              # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ backend/
â”‚   â”‚   â”œâ”€â”€ api/          # APIç«¯ç‚¹é›†æˆæµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ database/      # æ•°æ®åº“é›†æˆæµ‹è¯•
â”‚   â”‚   â””â”€â”€ workflows/    # ä¸šåŠ¡æµç¨‹æµ‹è¯•
â”‚   â””â”€â”€ frontend/          # å‰ç«¯é›†æˆæµ‹è¯•
â”‚       â”œâ”€â”€ api/          # APIè°ƒç”¨é›†æˆæµ‹è¯•
â”‚       â””â”€â”€ workflows/    # ç”¨æˆ·æµç¨‹æµ‹è¯•
â”œâ”€â”€ e2e/                   # ç«¯åˆ°ç«¯æµ‹è¯•
â”‚   â”œâ”€â”€ critical/         # å…³é”®è·¯å¾„æµ‹è¯•
â”‚   â”œâ”€â”€ smoke/            # å†’çƒŸæµ‹è¯•
â”‚   â””â”€â”€ api-contract/     # APIå¥‘çº¦E2Eæµ‹è¯•
â”œâ”€â”€ contract/               # APIå¥‘çº¦æµ‹è¯•æ¡†æ¶
â”‚   â”œâ”€â”€ api_contract_test.py
â”‚   â”œâ”€â”€ contract_scanner.py
â”‚   â”œâ”€â”€ frontend_scanner.py
â”‚   â””â”€â”€ fixtures/
â”œâ”€â”€ performance/            # æ€§èƒ½æµ‹è¯•
â”œâ”€â”€ fixtures/              # å…±äº«æµ‹è¯•æ•°æ®
â”œâ”€â”€ utils/                 # æµ‹è¯•å·¥å…·å‡½æ•°
â”œâ”€â”€ conftest.py           # Pytestæ ¹é…ç½®
â””â”€â”€ archive/               # å·²å½’æ¡£çš„æµ‹è¯•
    â””â”€â”€ disabled/
        â”œâ”€â”€ e2e/
        â””â”€â”€ backend/
```

---

## ğŸ” APIå¥‘çº¦æµ‹è¯•

### ç”¨é€”
éªŒè¯å‰ç«¯APIè°ƒç”¨ä¸åç«¯è·¯ç”±çš„ä¸€è‡´æ€§ï¼Œé˜²æ­¢APIä¸åŒ¹é…å¯¼è‡´çš„è¿è¡Œæ—¶é”™è¯¯ã€‚

### è¿è¡Œæ–¹å¼

```bash
# ä»…éªŒè¯ï¼ˆä½¿ç”¨ç°æœ‰æ‰«æç»“æœï¼‰
npm run test:contract

# é‡æ–°æ‰«æå¹¶éªŒè¯
python3 test/contract/api_contract_test.py --scan

# ç”Ÿæˆä¿®å¤å»ºè®®
python3 test/contract/api_contract_test.py --fix

# éªŒè¯ä¿®å¤åçš„ä»£ç 
python3 test/contract/api_contract_test.py --verify
```

### æ£€æµ‹å†…å®¹

- âœ… å‰ç«¯è°ƒç”¨çš„APIæ˜¯å¦åœ¨åç«¯å®ç°
- âœ… HTTPæ–¹æ³•æ˜¯å¦åŒ¹é…ï¼ˆGET/POST/PUT/DELETEï¼‰
- âœ… å‚æ•°æ ¼å¼æ˜¯å¦ä¸€è‡´ï¼ˆgame_gid vs game_idï¼‰
- âœ… åç«¯å®ç°çš„è·¯ç”±æ˜¯å¦è¢«å‰ç«¯ä½¿ç”¨

### ä¿®å¤é—®é¢˜

å½“å¥‘çº¦æµ‹è¯•å¤±è´¥æ—¶ï¼š

1. å®ç°ç¼ºå¤±çš„åç«¯è·¯ç”±
2. ä¿®å¤å‰ç«¯HTTPæ–¹æ³•ä¸åŒ¹é…
3. ç»Ÿä¸€å‚æ•°å‘½åï¼ˆä½¿ç”¨game_gidï¼‰
4. ç§»é™¤åºŸå¼ƒçš„å‰ç«¯APIè°ƒç”¨

---

## ğŸ¯ æµ‹è¯•æœ€ä½³å®è·µ

### 1. TDDå¼€å‘æ¨¡å¼

```bash
# 1. å…ˆå†™æµ‹è¯•ï¼ˆä¼šå¤±è´¥ï¼‰
# 2. ç¼–å†™ä»£ç ä½¿æµ‹è¯•é€šè¿‡
# 3. é‡æ„ä¼˜åŒ–
```

### 2. æäº¤å‰æµ‹è¯•

Git hooksä¼šè‡ªåŠ¨è¿è¡Œï¼š
- APIå¥‘çº¦æµ‹è¯•
- åç«¯å•å…ƒæµ‹è¯•ï¼ˆunitæ ‡è®°ï¼‰
- å‰ç«¯å•å…ƒæµ‹è¯•

### 3. æµ‹è¯•è¦†ç›–ç‡ç›®æ ‡

- **åç«¯**: æœ€ä½15%è¦†ç›–ç‡ï¼ˆå½“å‰é…ç½®ï¼‰
- **å‰ç«¯**: å»ºè®®è¦†ç›–æ‰€æœ‰å…³é”®è·¯å¾„

### 4. å¿«é€Ÿæµ‹è¯•ç­–ç•¥

- **Pre-commit**: ä»…è¿è¡Œå¿«é€Ÿæµ‹è¯•ï¼ˆ<10ç§’ï¼‰
- **æ‰‹åŠ¨**: è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶ï¼ˆåŒ…æ‹¬æ…¢é€Ÿæµ‹è¯•ï¼‰

---

## ğŸ› ï¸ å¼€å‘å·¥ä½œæµ

### åœºæ™¯1: ä¿®å¤Bug

```bash
# 1. ç¼–å†™é‡ç°bugçš„æµ‹è¯•
npm run test:watch

# 2. ä¿®å¤ä»£ç 

# 3. æµ‹è¯•é€šè¿‡åæäº¤
git add .
git commit  # è‡ªåŠ¨è¿è¡Œæµ‹è¯•

# 4. å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œcommitè¢«é˜»æ­¢
# ä¿®å¤å¹¶é‡æ–°æäº¤
```

### åœºæ™¯2: æ–°å¢åŠŸèƒ½

```bash
# 1. ç¼–å†™æµ‹è¯•ï¼ˆTDDï¼‰
# 2. å®ç°åŠŸèƒ½
# 3. è¿è¡Œå®Œæ•´æµ‹è¯•
npm run verify

# 4. æäº¤
git commit
```

### åœºæ™¯3: APIå˜æ›´

```bash
# 1. ä¿®æ”¹åç«¯API

# 2. é‡æ–°æ‰«æå¥‘çº¦
python3 test/contract/api_contract_test.py --scan

# 3. éªŒè¯ä¸€è‡´æ€§
npm run test:contract

# 4. å¦‚æœä¸ä¸€è‡´ï¼Œä¿®å¤å‰ç«¯æˆ–åç«¯

# 5. éªŒè¯é€šè¿‡åæäº¤
git commit
```

---

## ğŸ“Š å½“å‰æµ‹è¯•çŠ¶æ€

### åç«¯æµ‹è¯•
- **æ¡†æ¶**: pytest 7.4.3
- **é…ç½®æ–‡ä»¶**: [config/pytest.ini](../config/pytest.ini)
- **è¦†ç›–ç‡è¦æ±‚**: 15%æœ€ä½
- **æ ‡è®°**: unit, integration, e2e, contract, performance, database, api

### å‰ç«¯æµ‹è¯•
- **æ¡†æ¶**: Vitest (å•å…ƒ), Playwright (E2E)
- **é…ç½®æ–‡ä»¶**: [frontend/vitest.config.ts](../frontend/vitest.config.ts)
- **æµè§ˆå™¨**: Chromium, Firefox, WebKit

### å·²çŸ¥é—®é¢˜
1. **Node.js PATH**: éœ€è¦é…ç½® `export PATH="/usr/local/Cellar/node/25.6.0/bin:$PATH"`
2. **APIå¥‘çº¦**: 4ä¸ªç¼ºå¤±çš„åç«¯è·¯ç”±ï¼Œ18ä¸ªæ–¹æ³•ä¸åŒ¹é…
3. **æµ‹è¯•è¿ç§»**: éƒ¨åˆ†æµ‹è¯•éœ€è¦æ›´æ–°å¯¼å…¥è·¯å¾„

---

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜: æ‰¾ä¸åˆ°nodeå‘½ä»¤

**è§£å†³æ–¹æ¡ˆ**:
```bash
export PATH="/usr/local/Cellar/node/25.6.0/bin:$PATH"
```

æˆ–æ·»åŠ åˆ° `~/.zshrc`:
```bash
echo 'export PATH="/usr/local/Cellar/node/25.6.0/bin:$PATH"' >> ~/.zshrc
source ~/.zshrc
```

### é—®é¢˜: å¯¼å…¥é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**: ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•è¿è¡Œæµ‹è¯•
```bash
cd /Users/mckenzie/Documents/event2table
pytest test/unit/backend -v
```

### é—®é¢˜: Git Hooksä¸è¿è¡Œ

**è§£å†³æ–¹æ¡ˆ**: ç¡®ä¿hookså¯æ‰§è¡Œ
```bash
chmod +x .git/hooks/pre-commit
chmod +x .git/hooks/pre-push
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®README](../README.md)
- [å¼€å‘è§„èŒƒ](../CLAUDE.md)
- [æ¶æ„è®¾è®¡](../docs/development/architecture.md)
- [è´¡çŒ®æŒ‡å—](../docs/development/contributing.md)

---

**ç»´æŠ¤è€…**: Event2Table Development Team
**æœ€åæ›´æ–°**: 2026-02-11
